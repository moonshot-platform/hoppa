<html lang="en">
	<head>
		<title>Hoppa!</title>
		<meta charset="utf-8">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">

		<meta name="apple-mobile-web-app-title" content="Hoppa!">
		<meta name="application-name" content="Hoppa!">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		<meta name="format-detection" content="telephone=no">

		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">

		<meta property="twitter:card" content="assets/logo.webp">
		<meta property="twitter:url" content="https://moonarcade.games/hoppa">
		<meta property="twitter:title" content="Hoppa! A Ra8bits Platform Game">
		<meta property="twitter:description" content="2D Jump&Run Classic Platform Game">
		<meta property="twitter:image" content="assets/logo.webp">

		<meta name="msapplication-TileColor" content="#603cba">
		<meta name="theme-color" content="#8d93fc">

		<link rel="apple-touch-icon" sizes="180x180" href="src/apple-touch-icon.webp">
		<link rel="icon" type="image/webp" sizes="32x32" href="src/favicon-32x32.webp">
		<link rel="icon" type="image/webp" sizes="16x16" href="src/favicon-16x16.webp">
		<link rel="manifest" href="src/site.webmanifest">
		<link rel="mask-icon" href="src/safari-pinned-tab.svg" color="#8d93fc">

		<style>
			html,body { margin: 0px;padding:0; height: 100%; background-color:#000000;}
		    .add-button { position:absolute;top:1px; left:1px; font-size:3vw; width:100%;}
		</style>
		
	</head>
	<body>
	    <button class="add-button">Click to install Hoppa to your Desktop!</button>
		<script src="src/main.ts" type="module"></script>
	</body>
	<script type="text/javascript">


		window.addEventListener('beforeinstallprompt', (e) => {
			e.preventDefault();
			prompt = e;
			
			//button.style.display = 'block';

			button.addEventListener('click', () => {
				button.style.display = 'none';
				prompt.prompt();
				prompt.userChoice.then((choiceResult) => {
					if( choiceResult.outcome === 'accepted' ) {

					}
					prompt = null;
				});
			});
		});

		window.addEventListener('load', () => {
			window.setTimeout(() => { 
				let prompt;
				let button = document.querySelector('.add-button');
				button.style.display = 'none';
				if( 'serviceWorker' in navigator ) {
					const s = navigator.serviceWorker;
					s.register('sw.js',  { scope: "/hoppa/" } )
						.then( function(r) {
							console.log("Registered service worker ", r.scope);
						})
						.catch(function(e) {
							console.log("Service worker failed registration: ", e);
						});
				}
			}, 3000);
		});
		

	</script>
</html>
